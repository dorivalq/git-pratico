<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd">

	<changeSet author="fabiofernandes81" id="1">
        <createTable remarks="Cadastro do Estabelecimento/Obras do eSocial" tableName="TBR_CAD_0037_BUILD">
        	
        	<column name="IDT_BUILDING" remarks="Identificador único do Estabelecimento/Obras do eSocial" type="NUMBER(22)">
                <constraints nullable="false"/>
            </column>
            
            <column name="IDT_EMPLR" remarks="Identificador do Empregador" type="NUMBER(22)">
                <constraints nullable="false"/>
            </column>
            
            <column name="COD_REGISTRATION_TYPE" remarks="Indica o tipo de inscrição do estabelecimento/obra, podendo ser: 1 - CNPJ; 4 - CNO (Cadastro Nacional de Obra). Domínio DM_ESTAB_OBRA_TIPO_INSCRICAO." type="VARCHAR2(50)">
                <constraints nullable="false"/>
            </column>
            
			<column name="NUM_REGISTRATION" remarks="Número de inscrição do estabelecimento ou obra de construção civil." 
				type="VARCHAR2(15)">
                <constraints nullable="false"/>
            </column>
						                                    
            <!-- Framework -->
            <column name="D_LAST_UPDATE_DATE" remarks="Data da última atualização. Campo utilizado pela framework de aplicação de regras de negócio de validação." type="DATE" />           
            <column name="S_LAST_UPDATE_BY" remarks="Responsável pela última atualização. Campo utilizado pela framework de aplicação de regras de negócio de validação." type="VARCHAR2(250)" />
            <column name="D_CREATION_DATE" remarks="Data da criação do registro. Campo utilizado pela framework de aplicação de regras de negócio de validação." type="DATE" />
            <column name="S_CREATED_BY" remarks="Criado por. Campo utilizado pela framework de aplicação de regras de negócio de validação." type="VARCHAR2(250)" />
            
        </createTable>        
    </changeSet>
	
    <changeSet author="fabiofernandes81" id="2">
        <addUniqueConstraint columnNames="IDT_EMPLR, COD_REGISTRATION_TYPE, NUM_REGISTRATION" constraintName="UK_TBR_CAD_0037_BUILD_001" tableName="TBR_CAD_0037_BUILD"/>
    </changeSet>
	
    <changeSet author="fabiofernandes81" id="3">
        <addPrimaryKey columnNames="IDT_BUILDING" constraintName="PK_TBR_CAD_0037_BUILD" tableName="TBR_CAD_0037_BUILD"/>
    </changeSet>    

    <changeSet author="fabiofernandes81" id="4">
        <addForeignKeyConstraint baseColumnNames="IDT_EMPLR" baseTableName="TBR_CAD_0037_BUILD" constraintName="FK_TBR_CAD_0037_BUILD_001"  
                                 referencedColumnNames="IDT_EMPLR" referencedTableName="TBR_CAD_3016_EMPLR"/>
    </changeSet>

   

</databaseChangeLog>   