<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd">

	<changeSet author="fabiofernandes81" id="1">
        <createTable remarks="Contém o cadastro dos cargos previstos no quadro de empregados da organização. Este cadastro é utilizado para o EFD-Social, e está relacionado com os eventos de envio para o governo." 
        	tableName="TBR_CAD_0037_BLD_OC">
        	
        	<column name="IDT_BLD_OC" remarks="Identificador da Ocorrência do Estabelecimento/Obra" type="NUMBER(22)">
                <constraints nullable="false"/>
            </column>
            
            <column name="IDT_BUILDING" remarks="Identificador do Estabelecimento/Obra" type="NUMBER(22)">
                <constraints nullable="false"/>
            </column>
            
            <column name="DAT_OCCURENCE" remarks="Data da Ocorrência" type="DATE">
                <constraints nullable="false"/>
            </column>

            <column name="IND_LAYOUT_ESOCIAL" remarks="Informação de Controle.   Indicador utilizado para sinalizar que o layout  utilizado na integração foi o XML formato eSOCIAL. Preenchido com  S - Layout eSocial.N ou nulo - Layout Thomson Reuters;Domínio DM_SIM_NAO." type="CHAR(1)"/>                        

            <column name="COD_OPER" remarks="Informação de Controle.Indicador da operação proveniente do layout eSocial.Preenchido com : I -Inclusão;A - Alteração;E - Exclusão;IA - Inclusão ou Alteração; Domínio DM_TIPO_OPERACAO_INTEGRACAO." type="VARCHAR2(2)"/>
                
            <column name="COD_ID_EVENT" remarks="Identificador único do Evento eSocial (id)" type="VARCHAR2(36)"/>
                
            <column name="COD_EVENT" remarks="Código do Evento eSocial . Ex: S-1000, S-1020, etc " type="VARCHAR2(36)"/>
                
            <column name="IND_ENVIRONMENT" remarks="Identificação do ambiente (tpAmb): 1 - Produção; 2 - Pré-produção - dados reais; 3 - Pré-produção - dados fictícios. Domínio DM_EFD_EVENTO_TIPO_AMBIENTE." type="CHAR(1)"/>
                
            <column name="IND_PRC_EMI" remarks="Processo de emissão do evento eSocial (prcEmi) 1- Emissão com aplicativo do empregador Domínio DM_EFD_EVENTO_PROCESSO_EMISSAO." type="CHAR(1)"/>
                
            <column name="COD_VS_PROC" remarks="Versão do Processo emissor do evento eSocial (verProc)" type="VARCHAR2(20)"/>                

            <column name="IND_OC_EVT" remarks="Indicador de Ocorrência ou Evento: O - Ocorrência E - Evento " type="CHAR(1)"/>                            

            <column name="IND_STATUS" remarks="" type="CHAR(1)"/>
                
            <column name="DAT_INSERT_UPDATE" remarks="Data Início Validade do cadastro" type="DATE">
                <constraints nullable="false"/>
            </column>

            <column name="DAT_END_EFFECTIVE" remarks="Data Fim Validade do cadastro" type="DATE"/>
                
            <column name="DAT_INSERT_UPDATE_NEW" remarks="Nova Data Início de Validade" type="DATE"/>
                
            <column name="DAT_END_EFFECTIVE_NEW" remarks="Nova Data Fim de Validade" type="DATE"/>
                
            <column name="COD_ECONO_ACTV" remarks="Código de Atividade Econômica (CNAE)" type="VARCHAR2(7)"/>
                
            <column name="IND_ENVIR_RISK_WORK" remarks="Alíquota RAT (Riscos Ambientais do Trabalho)" type="NUMBER(1)"/>                

            <column name="PCT_ACCIDENT_PREV" remarks="FAP (Fator Acidentário de Prevenção)" type="NUMBER(7,4)"/>
                
            <column name="PCT_ADJUSTED_ENVIR_RISK_WK" remarks="Alíquota RAT ajustada pelo FAP " type="NUMBER(7,4)"/>
                
            <column name="IND_RISK_WORK_PRC" remarks="Tipo do Processo RAT correspondente ao Cadastro Processo Jurídico (CAD1001).  Preencher com: 1 - Administrativo 2 - Judicial" type="CHAR(1)"/>
                
            <column name="NUM_RISK_WORK_PRC" remarks="Número do Processo RAT correspondente ao Cadastro Processo Jurídico (CAD1001)." type="VARCHAR2(20)"/>
                
            <column name="IND_ACCIDENT_PREV_PRC" remarks="Tipo do Processo FAP correspondente ao Cadastro Processo Jurídico (CAD1001).  Preencher com: 1 - Administrativo 2 - Judicial" type="CHAR(1)"/>
                
            <column name="NUM_ACCIDENT_PREV_PRC" remarks="Número do Processo FAP correspondente ao Cadastro Processo Jurídico (CAD1001)." type="VARCHAR2(20)"/>
                
            <column name="IND_CONTRIBUTION_BULDING" remarks="Indicativo de Substituição da Contribuição Patronal de Obra de Construção Civil: 1 - Contribuição Patronal Substituída; 2 - Contribuição Patronal Não Substituída;" type="CHAR(1)"/>
                
            <column name="IDT_UPPER_LVL_BLD" remarks="Identificador da Ocorrência de Nível Superior" type="NUMBER(22)"/>
                            
            <!-- Framework -->
            <column name="D_LAST_UPDATE_DATE" remarks="Data da última atualização. Campo utilizado pela framework de aplicação de regras de negócio de validação." type="DATE">
            </column>
            <column name="S_LAST_UPDATE_BY" remarks="Responsável pela última atualização. Campo utilizado pela framework de aplicação de regras de negócio de validação." type="VARCHAR2(250)">
            </column>
            <column name="D_CREATION_DATE" remarks="Data da criação do registro. Campo utilizado pela framework de aplicação de regras de negócio de validação." type="DATE">
            </column>
            <column name="S_CREATED_BY" remarks="Criado por. Campo utilizado pela framework de aplicação de regras de negócio de validação." type="VARCHAR2(250)">
            </column>
        </createTable>        
    </changeSet>
	
    <changeSet author="fabiofernandes81" id="2">
        <addUniqueConstraint columnNames="IDT_BUILDING, DAT_OCCURENCE" constraintName="UK_TBR_CAD_0037_BLD_OC_001" tableName="TBR_CAD_0037_BLD_OC"/>        
    </changeSet>
	
    <changeSet author="fabiofernandes81" id="3">
        <addPrimaryKey columnNames="IDT_BLD_OC" constraintName="PK_TBR_CAD_0037_BLD_OC" tableName="TBR_CAD_0037_BLD_OC"/>
    </changeSet>    

    <changeSet author="fabiofernandes81" id="4">
        <addForeignKeyConstraint baseColumnNames="IDT_BUILDING" baseTableName="TBR_CAD_0037_BLD_OC" constraintName="FK_TBR_CAD_0037_BLD_OC_001"  
        						 referencedColumnNames="IDT_BUILDING" referencedTableName="TBR_CAD_0037_BUILD"/>
    </changeSet>    

    <changeSet author="fabiofernandes81" id="5">
        <addForeignKeyConstraint baseColumnNames="IDT_UPPER_LVL_BLD" baseTableName="TBR_CAD_0037_BLD_OC" constraintName="FK_TBR_CAD_0037_BLD_OC_002"  
                                 referencedColumnNames="IDT_BLD_OC" referencedTableName="TBR_CAD_0037_BLD_OC"/>
    </changeSet>    
</databaseChangeLog>   